<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viego: The Ruined King RPG</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap');

        :root {
            --ruined-green: #0ac8b9;
            --dark-bg: #05080a;
            --power-yellow: #f1c40f;
            --hp-red: #c0392b;
            --crit-color: #ffcc00;
            --heal-color: #2ecc71;
        }

        body {
            background-color: var(--dark-bg);
            background-image: linear-gradient(rgba(0,0,0,0.8), rgba(0,20,20,0.9)), url('https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Viego_0.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: #e0e0e0;
            font-family: 'Cinzel', serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            user-select: none;
        }

        /* KONU≈ûMA BALONCUKLARI */
        .speech-bubble {
            position: absolute;
            top: -80px;
            left: 50%;
            transform: translateX(-50%);
            background: #fff;
            color: #000;
            padding: 10px 15px;
            border-radius: 15px;
            font-family: sans-serif;
            font-size: 12px;
            font-weight: bold;
            width: 200px;
            text-align: center;
            z-index: 200;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s, transform 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            border: 2px solid var(--ruined-green);
        }
        /* Konu≈üma oku */
        .speech-bubble::after {
            content: ''; position: absolute; bottom: -10px; left: 50%; margin-left: -10px;
            border-width: 10px 10px 0; border-style: solid; border-color: #fff transparent; display: block; width: 0;
        }
        .speech-visible { opacity: 1; transform: translateX(-50%) translateY(-10px); }

        /* U√áAN YAZILAR */
        .float-text {
            position: absolute; font-weight: bold; font-size: 24px; pointer-events: none;
            animation: floatUp 1.2s ease-out forwards; text-shadow: 2px 2px 0 #000; z-index: 100;
        }
        @keyframes floatUp {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            50% { transform: translateY(-40px) scale(1.2); opacity: 1; }
            100% { transform: translateY(-80px) scale(1); opacity: 0; }
        }
        .text-damage { color: #fff; }
        .text-crit { color: var(--crit-color); font-size: 36px; text-shadow: 0 0 15px red; }
        .text-heal { color: var(--heal-color); font-size: 28px; }
        .text-enemy-dmg { color: #e74c3c; }

        /* EFEKTLER */
        .damage-flash { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 0, 0, 0.3); pointer-events: none; z-index: 50; animation: flash 0.2s linear; }
        .ult-flash { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(10, 200, 185, 0.5); pointer-events: none; z-index: 50; animation: flash 1s linear; }
        @keyframes flash { from { opacity: 1; } to { opacity: 0; } }

        .game-wrapper {
            width: 90%; max-width: 1000px; background: rgba(10, 12, 15, 0.95);
            border: 2px solid #333; border-top: 4px solid var(--ruined-green);
            box-shadow: 0 0 50px rgba(10, 200, 185, 0.1); padding: 20px;
            position: relative; display: flex; flex-direction: column; height: 600px;
        }

        #start-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 100; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        .start-btn { padding: 15px 40px; font-size: 1.5rem; background: transparent; color: var(--ruined-green); border: 2px solid var(--ruined-green); font-family: 'Cinzel', serif; cursor: pointer; transition: 0.3s; margin-top: 30px; }
        .start-btn:hover { background: var(--ruined-green); color: black; box-shadow: 0 0 30px var(--ruined-green); }

        .battle-scene { flex-grow: 1; display: flex; justify-content: space-between; align-items: center; padding: 0 40px; }
        .character-box { width: 250px; text-align: center; position: relative; }
        .character-img { width: 200px; height: 200px; object-fit: cover; border-radius: 50%; border: 4px solid #444; box-shadow: 0 0 20px rgba(0,0,0,0.5); transition: transform 0.2s; }
        .viego-glow { border-color: var(--ruined-green); box-shadow: 0 0 30px rgba(10, 200, 185, 0.3); }
        .enemy-glow { border-color: #d63031; box-shadow: 0 0 30px rgba(214, 48, 49, 0.3); }
        
        .shake { animation: shake 0.5s; }
        @keyframes shake { 0% { transform: translate(1px, 1px) rotate(0deg); } 10% { transform: translate(-1px, -2px) rotate(-1deg); } 50% { transform: translate(-1px, 2px) rotate(-1deg); } 100% { transform: translate(1px, -2px) rotate(-1deg); } }

        .stat-bar { width: 100%; height: 15px; background: #222; margin-top: 8px; border: 1px solid #444; position: relative; }
        .fill { height: 100%; transition: width 0.5s ease-out; }
        .hp-fill { background-color: var(--hp-red); }
        .power-fill { background-color: var(--power-yellow); box-shadow: 0 0 10px var(--power-yellow); }
        .bar-text { font-size: 12px; position: absolute; width: 100%; text-align: center; top: -2px; text-shadow: 1px 1px 2px black; }

        .controls { height: 150px; border-top: 1px solid #444; display: grid; grid-template-columns: 2fr 1fr; gap: 20px; padding-top: 20px; }
        .skills { display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 10px; }
        .skill-btn { background: #111; border: 1px solid #444; color: #aaa; font-family: 'Cinzel', serif; cursor: pointer; position: relative; transition: 0.2s; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 5px; }
        .skill-btn:hover:not(:disabled) { border-color: var(--ruined-green); color: white; background: #1a1a1a; }
        .skill-btn:disabled { opacity: 0.3; cursor: not-allowed; border-color: #333; color: #555; }
        .skill-name { font-weight: bold; font-size: 0.8rem; text-align: center; }
        .skill-cost { font-size: 0.7rem; color: var(--power-yellow); margin-top: 3px; }
        .cooldown-text { color: #e74c3c; font-size: 0.7rem; display:none; }
        .ult-btn { border-color: var(--ruined-green); color: var(--ruined-green); }
        .ult-btn:hover:not(:disabled) { background: var(--ruined-green); color: black; }

        .log-box { background: rgba(0,0,0,0.5); border: 1px solid #333; padding: 10px; font-size: 0.9rem; overflow-y: auto; color: #ccc; font-family: sans-serif; }
        .overlay-msg { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.9); padding: 40px; border: 2px solid var(--ruined-green); text-align: center; display: none; z-index: 50; }
        .overlay-msg h2 { color: var(--ruined-green); font-size: 2rem; margin-bottom: 20px; }
        .level-badge { position: absolute; top: -10px; right: -10px; background: var(--ruined-green); color: black; width: 30px; height: 30px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-weight: bold; border: 2px solid white; }
        .music-toggle { position: fixed; top: 20px; right: 20px; z-index: 200; background: rgba(0,0,0,0.5); color: white; border: 1px solid #555; padding: 5px 10px; cursor: pointer; }
        .back-btn { position: fixed; top: 20px; left: 20px; z-index: 200; color: var(--ruined-green); text-decoration: none; border: 1px solid var(--ruined-green); padding: 5px 15px; background: rgba(0,0,0,0.8); font-weight: bold; }
    </style>
</head>
<body>

    <a href="index.html" class="back-btn">‚Üê Men√º</a>
    <div id="flash-effect"></div>
    <button class="music-toggle" onclick="forcePlayMusic()">üéµ M√úZƒ∞ƒûƒ∞ BA≈ûLAT</button>

    <audio id="bgMusic" loop preload="auto">
        <source src="https://opengameart.org/sites/default/files/Heroic%20Demise%20%28New%29.mp3" type="audio/mpeg">
    </audio>

    <div class="game-wrapper">
        <div id="start-screen">
            <h1 style="color: #fff;">MAHVOLMU≈û KRAL'IN</h1>
            <h1>ƒ∞NTƒ∞KAMI</h1>
            <p style="color: #aaa; margin-top: 10px;">"Hepsi... Onun i√ßin."</p>
            <button class="start-btn" onclick="startGame()">Hƒ∞KAYEYE BA≈ûLA</button>
            <p style="font-size: 12px; color: #666; margin-top: 20px;">(M√ºzik √ßalmazsa saƒü √ºstteki butona basƒ±n)</p>
        </div>

        <div id="overlay" class="overlay-msg">
            <h2 id="overlay-title">ZAFER</h2>
            <p id="overlay-quote">"..."</p>
            <div id="level-up-text" style="color: yellow; margin-bottom: 15px; display:none;">SEVƒ∞YE ATLADIN!</div>
            <button class="start-btn" id="next-btn" onclick="nextLevel()">DEVAM ET</button>
        </div>

        <div class="battle-scene">
            <div class="character-box" id="player-box">
                <div class="speech-bubble" id="player-bubble">Konu≈üma metni...</div>
                <div class="level-badge" id="player-lvl">1</div>
                <img src="https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Viego_0.jpg" class="character-img viego-glow" id="player-img">
                <h2 style="color: var(--ruined-green);">VIEGO</h2>
                
                <div class="stat-bar">
                    <div class="fill hp-fill" id="player-hp-bar" style="width: 100%;"></div>
                    <span class="bar-text" id="player-hp-text">100/100</span>
                </div>
                <div class="stat-bar" style="border-color:#b7950b;">
                    <div class="fill power-fill" id="player-power-bar" style="width: 0%;"></div>
                    <span class="bar-text" id="player-power-text" style="color:black; font-weight:bold; text-shadow:none;">0/100</span>
                </div>
            </div>

            <h1 style="color: #555; font-size: 3rem;">VS</h1>

            <div class="character-box" id="enemy-box">
                <div class="speech-bubble" id="enemy-bubble">Konu≈üma metni...</div>
                <div class="level-badge" id="enemy-lvl" style="background: #d63031; color: white;">1</div>
                <img src="" class="character-img enemy-glow" id="enemy-img">
                <h2 style="color: #d63031;" id="enemy-name">D√ú≈ûMAN</h2>
                
                <div class="stat-bar">
                    <div class="fill hp-fill" id="enemy-hp-bar" style="width: 100%;"></div>
                    <span class="bar-text" id="enemy-hp-text">100/100</span>
                </div>
            </div>
        </div>

        <div class="controls">
            <div class="skills">
                <button class="skill-btn" onclick="useSkill('basic')">
                    <span class="skill-name">Kralƒ±n Kƒ±lƒ±cƒ±</span>
                    <span class="skill-cost" style="color:#2ecc71;">+G√º√ß</span>
                </button>
                
                <button class="skill-btn" id="btn-q" onclick="useSkill('q')">
                    <span class="skill-name">M. Kralƒ±n Kƒ±lƒ±cƒ± (Q)</span>
                    <span class="skill-cost">15 G√º√ß</span>
                    <span style="font-size:10px; color:#aaa;">%7 Rakip HP √áal</span>
                </button>

                <button class="skill-btn" id="btn-w" onclick="useSkill('w')">
                    <span class="skill-name">Hortlakƒ±n Pen√ßesi (W)</span>
                    <span class="skill-cost">25 G√º√ß</span>
                    <span class="cooldown-text" id="cd-w">Bekleme: 2</span>
                </button>

                <button class="skill-btn ult-btn" id="btn-ult" onclick="useSkill('r')">
                    <span class="skill-name">KALP KIRAN (R)</span>
                    <span class="skill-cost">TEK KULLANIM</span>
                </button>
            </div>

            <div class="log-box" id="combat-log">
                Sava≈ü ba≈ülƒ±yor... Isolde seni bekliyor.
            </div>
        </div>
    </div>

<script>
    // --- SES EFEKTLERƒ∞ MOTORU (WEB AUDIO API) ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    
    function playSkillSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        osc.connect(gainNode);
        gainNode.connect(audioCtx.destination);
        const now = audioCtx.currentTime;

        if (type === 'q') {
            // Keskin Kƒ±lƒ±√ß Sesi (Y√ºksek frekanslƒ± sweep)
            osc.type = 'triangle';
            osc.frequency.setValueAtTime(800, now);
            osc.frequency.exponentialRampToValueAtTime(100, now + 0.15);
            gainNode.gain.setValueAtTime(0.2, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.15);
            osc.start(now);
            osc.stop(now + 0.2);
        } else if (type === 'w') {
            // Sis Sesi (Daha boƒüuk ve uzun)
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(150, now);
            osc.frequency.linearRampToValueAtTime(50, now + 0.5);
            gainNode.gain.setValueAtTime(0.1, now);
            gainNode.gain.linearRampToValueAtTime(0.01, now + 0.5);
            osc.start(now);
            osc.stop(now + 0.5);
        } else if (type === 'r') {
            // Ulti Sesi (Aƒüƒ±r darbe)
            osc.type = 'square';
            osc.frequency.setValueAtTime(100, now);
            osc.frequency.exponentialRampToValueAtTime(10, now + 0.5);
            gainNode.gain.setValueAtTime(0.4, now);
            gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.8);
            osc.start(now);
            osc.stop(now + 0.8);
        }
    }

    // --- OYUN VERƒ∞LERƒ∞ ---
    const player = {
        name: "Viego", level: 1, maxHp: 150, hp: 150, maxPower: 100, power: 0,
        ultUsed: false, critChance: 0.2, nextHitCrit: false, wCooldown: 0,
        quotes: ["Isolde...", "Yolumdan √ßekil!", "A≈ük her ≈üeyi mahveder.", "Ruhunu alacaƒüƒ±m.", "Karanlƒ±k yayƒ±lƒ±yor."]
    };

    const enemies = [
        {
            name: "LeBlanc", level: 3, maxHp: 180, hp: 180, damage: 15,
            img: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Leblanc_0.jpg",
            winQuote: "Viego: \"Yalanlarƒ±n bitti, Hilekar.\"",
            quotes: ["G√∂z yanƒ±lmasƒ±.", "Ger√ßekten kral mƒ±sƒ±n?", "√áok safsƒ±n.", "Kaybolacaksƒ±n."]
        },
        {
            name: "Vladimir", level: 6, maxHp: 250, hp: 250, damage: 25,
            img: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Vladimir_0.jpg",
            winQuote: "Viego: \"Kanƒ±n bana ait amca.\"",
            quotes: ["Kanƒ±n kokusu...", "Harika bir tat.", "Yeƒüenim, dur artƒ±k.", "Sanat yapƒ±yorum."]
        },
        {
            name: "Sahn-Uzal", level: 10, maxHp: 450, hp: 450, damage: 40,
            img: "https://ddragon.leagueoflegends.com/cdn/img/champion/splash/Mordekaiser_0.jpg",
            winQuote: "Viego: \"√ñl√ºler diyarƒ± benimdir!\"",
            quotes: ["Demir ebedidir.", "Zayƒ±fsƒ±n.", "Ruhun benim.", "Yƒ±kƒ±l."]
        }
    ];

    let currentEnemyIndex = 0;
    let turn = "player"; 
    const bgMusic = document.getElementById('bgMusic');

    function forcePlayMusic() {
        bgMusic.volume = 0.1; // SES KISILDI
        bgMusic.play().then(() => { document.querySelector('.music-toggle').innerText = "üéµ M√ºzik: A√áIK"; })
        .catch(error => { console.log(error); });
    }
    function toggleMusic() {
        if(bgMusic.paused) { bgMusic.play(); document.querySelector('.music-toggle').innerText = "üéµ M√ºzik: A√áIK"; }
        else { bgMusic.pause(); document.querySelector('.music-toggle').innerText = "üéµ M√ºzik: KAPALI"; }
    }

    function startGame() {
        document.getElementById('start-screen').style.display = 'none';
        forcePlayMusic();
        loadLevel(0);
    }

    function loadLevel(index) {
        currentEnemyIndex = index;
        const enemy = enemies[index];
        document.getElementById('enemy-name').innerText = enemy.name.toUpperCase();
        document.getElementById('enemy-img').src = enemy.img;
        document.getElementById('enemy-lvl').innerText = enemy.level;
        player.ultUsed = false; player.power = 0; player.wCooldown = 0; player.nextHitCrit = false;
        updateUI();
        log(`Bir d√º≈üman belirdi: ${enemy.name}!`);
        document.getElementById('overlay').style.display = 'none';
    }

    // --- Dƒ∞YALOG Sƒ∞STEMƒ∞ (BANTER) ---
    function triggerBanter(isPlayerTurn) {
        // %30 ≈üansla konu≈üma tetiklenir
        if (Math.random() > 0.3) return;

        const enemy = enemies[currentEnemyIndex];
        
        if (isPlayerTurn) {
            // Viego konu≈üur
            const text = player.quotes[Math.floor(Math.random() * player.quotes.length)];
            showSpeech('player', text);
        } else {
            // D√º≈üman konu≈üur
            const text = enemy.quotes[Math.floor(Math.random() * enemy.quotes.length)];
            showSpeech('enemy', text);
        }
    }

    function showSpeech(who, text) {
        const bubble = document.getElementById(who + '-bubble');
        bubble.innerText = text;
        bubble.classList.add('speech-visible');
    }

    function clearBubbles() {
        document.getElementById('player-bubble').classList.remove('speech-visible');
        document.getElementById('enemy-bubble').classList.remove('speech-visible');
    }

    // --- YETENEKLER ---
    function useSkill(type) {
        if (turn !== "player") return;

        clearBubbles(); // Eski konu≈ümalarƒ± temizle
        triggerBanter(true); // Viego konu≈üabilir

        const enemy = enemies[currentEnemyIndex];
        let damage = 0; let logMsg = ""; let powerGain = 0; let isCrit = false;

        if (player.nextHitCrit) { isCrit = true; player.nextHitCrit = false; }
        else { if (Math.random() < player.critChance) isCrit = true; }

        if (type === 'basic') {
            playSkillSound('q'); // Kƒ±lƒ±√ß sesi
            damage = 15 + (player.level * 5);
            powerGain = isCrit ? 15 : Math.floor(Math.random() * 11) + 5;
            logMsg = `Viego kƒ±lƒ±cƒ±nƒ± savurdu!`;
        } 
        else if (type === 'q') {
            if (player.power < 15) { log("Yetersiz G√º√ß!"); return; }
            playSkillSound('q'); 
            player.power -= 15;
            damage = 30 + (player.level * 8);
            logMsg = `Viego Q kullandƒ±!`;
            
            // YENƒ∞ Q MANTIƒûI: Rakibin O ANKƒ∞ canƒ±nƒ±n %7'si
            let heal = Math.floor(enemy.hp * 0.07);
            if(heal < 5) heal = 5; // Minimum iyile≈üme
            
            player.hp += heal;
            if (player.hp > player.maxHp) player.hp = player.maxHp;
            showFloatingText(document.getElementById('player-box'), `+${heal}`, 'heal');
        }
        else if (type === 'w') {
            if (player.wCooldown > 0) { log("W beklemede!"); return; }
            if (player.power < 25) { log("Yetersiz G√º√ß!"); return; }
            playSkillSound('w');
            player.power -= 25;
            damage = 40 + (player.level * 6);
            player.nextHitCrit = true;
            player.wCooldown = 3;
            logMsg = `Viego Sisi serbest bƒ±raktƒ±!`;
        }
        else if (type === 'r') {
            if (player.ultUsed) { log("Ulti kullanƒ±ldƒ±!"); return; }
            playSkillSound('r');
            player.ultUsed = true;
            damage = 100 + (player.level * 15);
            triggerEffect('ult');
            logMsg = `VIEGO KALBƒ∞Nƒ∞ KIRDI!`;
            isCrit = true;
        }

        if (isCrit && type !== 'w') { damage *= 2; logMsg += " (KRƒ∞Tƒ∞K!)"; }

        player.power += powerGain;
        if (player.power > player.maxPower) player.power = player.maxPower;

        enemy.hp -= damage;
        if (enemy.hp < 0) enemy.hp = 0;

        shakeElement(document.getElementById('enemy-img'));
        showFloatingText(document.getElementById('enemy-box'), damage, isCrit ? 'crit' : 'normal');
        log(`${logMsg} ${damage} hasar.`);
        updateUI();

        if (enemy.hp <= 0) { winBattle(); return; }
        turn = "enemy"; setTimeout(enemyTurn, 1500); // Sƒ±ra bekleme s√ºresini biraz artƒ±rdƒ±m
    }

    function enemyTurn() {
        clearBubbles();
        triggerBanter(false); // D√º≈üman konu≈üabilir

        const enemy = enemies[currentEnemyIndex];
        let dmg = enemy.damage + Math.floor(Math.random() * 10);
        player.hp -= dmg;
        if (player.hp < 0) player.hp = 0;

        if (player.wCooldown > 0) player.wCooldown--;

        triggerEffect('damage');
        shakeElement(document.getElementById('player-img'));
        showFloatingText(document.getElementById('player-box'), `-${dmg}`, 'damage');
        updateUI();
        log(`${enemy.name} saldƒ±rdƒ±! ${dmg} hasar aldƒ±n.`);

        if (player.hp <= 0) {
            log("Viego d√º≈üt√º...");
            setTimeout(() => { alert("KAYBETTƒ∞N. Tekrar dene..."); location.reload(); }, 1000);
            return;
        }
        turn = "player";
    }

    function winBattle() {
        const enemy = enemies[currentEnemyIndex];
        document.getElementById('overlay-title').innerText = "D√ú≈ûMAN KATLEDƒ∞LDƒ∞";
        document.getElementById('overlay-quote').innerText = enemy.winQuote;
        player.level++; player.maxHp += 50; player.hp = player.maxHp; 
        document.getElementById('level-up-text').style.display = 'block';
        document.getElementById('overlay').style.display = 'block';
    }

    function nextLevel() {
        currentEnemyIndex++;
        if (currentEnemyIndex >= enemies.length) {
            alert("TEBRƒ∞KLER! OYUN Bƒ∞TTƒ∞."); location.reload();
        } else {
            loadLevel(currentEnemyIndex);
        }
    }

    function updateUI() {
        const pHpPerc = (player.hp / player.maxHp) * 100;
        const pPowPerc = (player.power / player.maxPower) * 100;
        document.getElementById('player-hp-bar').style.width = pHpPerc + '%';
        document.getElementById('player-hp-text').innerText = `${Math.floor(player.hp)}/${player.maxHp}`;
        document.getElementById('player-power-bar').style.width = pPowPerc + '%';
        document.getElementById('player-power-text').innerText = `${player.power}/${player.maxPower}`;
        document.getElementById('player-lvl').innerText = player.level;

        const enemy = enemies[currentEnemyIndex];
        const eHpPerc = (enemy.hp / enemy.maxHp) * 100;
        document.getElementById('enemy-hp-bar').style.width = eHpPerc + '%';
        document.getElementById('enemy-hp-text').innerText = `${Math.floor(enemy.hp)}/${enemy.maxHp}`;
        
        document.getElementById('btn-q').disabled = player.power < 15;
        document.getElementById('btn-w').disabled = (player.power < 25 || player.wCooldown > 0);
        document.getElementById('btn-ult').disabled = player.ultUsed;

        if(player.wCooldown > 0) {
            document.getElementById('cd-w').style.display = 'block';
            document.getElementById('cd-w').innerText = `Bekleme: ${player.wCooldown}`;
        } else {
            document.getElementById('cd-w').style.display = 'none';
        }
    }

    function log(msg) {
        const box = document.getElementById('combat-log');
        box.innerHTML = `> ${msg}<br>` + box.innerHTML;
    }
    function shakeElement(el) { el.classList.remove('shake'); void el.offsetWidth; el.classList.add('shake'); }
    function triggerEffect(type) {
        const flash = document.getElementById('flash-effect'); flash.className = ''; 
        if (type === 'damage') flash.classList.add('damage-flash');
        if (type === 'ult') flash.classList.add('ult-flash');
        setTimeout(() => flash.className = '', 500);
    }
    function showFloatingText(target, val, type) {
        const text = document.createElement('div');
        text.className = 'float-text ' + (type === 'crit' ? 'text-crit' : (type === 'heal' ? 'text-heal' : (type === 'damage' ? 'text-enemy-dmg' : 'text-damage')));
        text.innerText = type === 'crit' ? val + "!" : val;
        const rect = target.getBoundingClientRect();
        text.style.left = (rect.left + rect.width / 2) + 'px';
        text.style.top = rect.top + 'px';
        document.body.appendChild(text);
        setTimeout(() => text.remove(), 1200);
    }
</script>

</body>
</html>
